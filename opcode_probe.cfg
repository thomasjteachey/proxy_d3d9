# Spirit healer opcode probe configuration
# Copy this file next to the built proxy module (d3d9.dll / proxy_d3d9.dll) inside your WoW folder.
# The probe code automatically looks for opcode_probe.cfg in the same directory as the DLL.

# Select probe mode:
#   discover - hook WSASend and print stacks to find callsites
#   sender   - hook the packet sender and (optionally) a spirit healer caller
phase = sender

# RVA (wow.exe + offset) of the function that queues outbound packets.
# This matches the value that previously lived in PROBE_SENDER_RVA.
sender_rva = 0x0065B660

# RVA for the 0x02E2 caller we want to inspect (from AC logs).
# Leaving this blank disables the caller detour while keeping sender logging active.
caller_rva = 0x004F3D90

# Flags/booleans the caller logic consults while deciding to emit CMSG_AREA_SPIRIT_HEALER_QUERY.
# Format: name@offset[|bit]
#   offset        - signed byte offset from the caller's `this` pointer unless prefixed with "abs:".
#   abs:offset    - read from wow.exe + offset instead of from `this`.
#   |bit          - optional bit index (0..31) inside the dword at the computed address. Omit to read a byte.
# Entries are comma-separated; whitespace is ignored.
caller_flags = \
    hasCorpse@0x1B4, \
    corpseReleased@0x1B5, \
    deathTimerActive@0x1B6, \
    ghostForm@0x1B7, \
    playerGhostFlag@0x0D34|4, \
    playerDeadFlag@0x0D34|5, \
    inBattleground@abs:0x00C79F08|1, \
    inArena@abs:0x00C79F08|2
